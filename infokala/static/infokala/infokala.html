<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Infokala</title>
    <link rel="stylesheet" href="/static/infokala/bootstrap.min.css">
    <link rel="stylesheet" href="/static/infokala/infokala.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script defer src="config.js"></script>
    <script defer src="/static/infokala/infokala.js"></script>
  </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header"><a href class="navbar-brand">Infokala</a></div>
        <div id="base-navbar-collapse" style="display: none" data-bind="visible: true" class="collapse navbar-collapse">
          <ul data-bind="foreach: messageTypeFilters" class="nav navbar-nav">
            <li data-bind="css: { active: slug === $parent.activeFilter().slug }"><a href data-bind="text: name, click: $parent.activeFilter"></a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown"><a href data-toggle="dropdown" class="dropdown-toggle"><span data-bind="text: config.user.displayName"></span><b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href data-bind="attr: { href: config.logoutUrl }">Kirjaudu ulos</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="infokala-push-top"></div>
    <div style="display: none" data-bind="visible: true, foreach: visibleMessages" class="container">
      <div data-bind="attr: {id: &quot;infokala-message-&quot; + id}, css: { &quot;infokala-message-cycleable&quot;: $parent.isMessageCycleable($data), &quot;infokala-message-deleted&quot;: isDeleted }" class="infokala-message">
        <div data-bind="click: $parent.cycleMessageState" class="row infokala-action-row">
          <div class="col-md-12 text-muted">
            <div class="pull-right"><span data-bind="visible: $parent.isMessageCycleable($data)"><span data-bind="text: state.name, css: state.labelClass" class="label"></span><span data-bind="with: $parent.nextState($data)" class="infokala-next-state"><span class="text-muted">&thinsp;&rArr;&thinsp;</span><span data-bind="text: name, css: labelClass" class="label"></span></span></span>&emsp;<span data-bind="visible: $parent.shouldShowMessageType(), text: messageType.name" class="label label-default"></span>&emsp;<span data-bind="click: $parent.editMessage, clickBubble: false" class="btn btn-xs btn-primary infokala-edit-message-button">&#x270e;</span>&emsp;<span data-bind="click: $parent.deleteMessage, clickBubble: false" class="btn btn-xs btn-danger infokala-delete-message-button">&times;</span>
            </div>
            <div data-bind="text: formattedTime" class="small"></div>
          </div>
        </div>
        <div data-bind="css: {&quot;infokala-inactive&quot;: !state.active}, click: $parent.openMessage" class="row infokala-message-text"><strong data-bind="text: author" class="col-md-1"></strong>
          <div data-bind="text: message, visible: $parent.editingMessage() !== id, css: {&quot;infokala-edit-pending&quot;: isEditPending}" class="col-md-11"></div>
          <form data-bind="submit: $parent.handleEdit" role="form" class="col-md-9">
            <input type="text" data-bind="textInput: message, visible: $parent.editingMessage() === id, click: function(){}, clickBubble: false, event: {blur: $parent.handleEdit}" class="form-control infokala-edit-field">
          </form>
        </div>
        <div data-bind="visible: $parent.detailsMessage() === id, click: $parent.openMessage" class="infokala-message-history">
          <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-11 h5 infokala-history-header">Kommentoi</div>
          </div>
          <div class="row">
            <div class="col-md-1"></div>
            <div data-bind="text: (new Date()).toLocaleTimeString(&quot;fi-FI&quot;).replace(/\./g, &quot;:&quot;)" class="col-md-1 infokala-timestamp"></div>
            <div data-bind="text: $parent.author() + &quot;:&quot;" class="col-md-1"></div>
            <form data-bind="submit: $parent.handleComment, disabled: $parent.commentPending, click: function(){}, clickBubble: false" role="form" class="col-md-8 infokala-comment-form">
              <input type="text" data-bind="textInput: $parent.newComment" class="form-control infokala-comment-field">
            </form>
          </div>
          <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-11 h5 infokala-history-header">Historia</div>
          </div>
          <div data-bind="foreach: $parent.messageEventList" class="row infokala-message-event">
            <div class="col-md-1"></div>
            <div data-bind="text: time" class="col-md-1 infokala-timestamp"></div>
            <div data-bind="text: author + &quot;:&quot;" class="col-md-1"></div>
            <div data-bind="html: html, css: classes" class="col-md-9"></div>
          </div>
        </div>
      </div>
    </div>
    <div style="display: none" data-bind="visible: true" class="container">
      <form data-bind="submit: sendMessage" role="form" class="infokala-message-form">
        <div class="row">
          <div class="col-md-1 infokala-author-col">
            <input data-bind="value: author" class="form-control">
          </div>
          <div data-bind="css: { &quot;col-md-9&quot;: shouldShowMessageType(), &quot;col-md-11&quot;: !shouldShowMessageType(), &quot;infokala-message-col-middle&quot;: shouldShowMessageType() }" class="infokala-message-col">
            <input data-bind="value: message" placeholder="Viesti..." class="form-control">
          </div>
          <div data-bind="visible: shouldShowMessageType()" class="col-md-2 infokala-message-type-col">
            <select data-bind="options: config.messageTypes, optionsText: &quot;name&quot;, optionsValue: &quot;slug&quot;, value: manualMessageType" class="form-control"></select>
          </div>
        </div>
        <input type="submit" class="hidden">
      </form>
    </div>
  </body>
</html>